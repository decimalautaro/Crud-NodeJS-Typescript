<!DOCTYPE html>
<html lang="es">

<%- include('../template/cabecera') %>

  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container">
        <a class="navbar-brand" href="./profile"><img src="img/icon.png" alt="Node.js icon" class="nav-icon"></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <%- include ('../template/ul') %>
            <form class="d-flex" action="./search-servicio" method="GET">
              <input class="form-control me-2" type="search" placeholder="Buscar" aria-label="Buscar" name="search">
              <button class="btn secondary-btn" type="submit">Buscar</button>
            </form>
            <a href="/logout" class="btn btn-secondary ms-4">Cerrar sesion</a>
        </div>
      </div>
    </nav>
    <br>
    <div class="row container centered" width="100vw">
      <div class="position-absolute">
        <%- include ('../message/message') %>
      </div>
      <div class="text-center">
        <h2>Prestaciones de Servicio</h2>
      </div>
      <br>
      <br>
      <br>
      <div class="table-wrapper-scroll-y my-custom-scrollbar">
        <table class="table table-hover">
          <thead class="table-dark text-center">
            <th scope="col">Usuario</th>
            <th scope="col">Técnico</th>
            <th scope="col">Servicio</th>
            <th scope="col">Insumo</th>
            <th scope="col">Tipo de Prestacion</th>
            <th scope="col">Creacion</th>
            <th scope="col">Actualizacion</th>
            <th scope="col">Acciones</th>
          </thead>
          <tbody class="text-center">
            <% prestacionServicio.forEach(function(prestacionServicio) { %>
              <tr>
                <td>
                  <%= prestacionServicio.user.name %>
                </td>
                <td>
                  <%= prestacionServicio.tecnico.nombre %>
                </td>
                <td>
                  <%= prestacionServicio.servicio.tipoServicio %>
                </td>
                <td>
                  <%= prestacionServicio.insumo.tipo %>, <%= prestacionServicio.insumo.marca %>, <%= prestacionServicio.insumo.modelo %>
                </td>
                <td>
                  <%= prestacionServicio.tipoPrestacion %>
                </td>
                <td>
                  <%= prestacionServicio.created_at.toLocaleDateString() %>
                    <%= prestacionServicio.created_at.toLocaleTimeString() %>
                </td>
                <td>
                  <%= prestacionServicio.updated_at.toLocaleDateString() %>
                    <%= prestacionServicio.updated_at.toLocaleTimeString() %>
                </td>
                <td class="d-flex justify-content-center">
                  <div class="row">
                    <div class="col-6">
                      <form action="./edit-prestacion" method="GET">
                        <input type="hidden" name="id" value="<%= prestacionServicio.id %>">
                        <button type="submit" data-bs-toggle="tooltip" data-bs-placement="top" title="Editar"
                          class="btn btn-outline-secondary border"><i class="bi bi-pencil"></i></button>
                      </form>
                    </div>
                    <div class="col-6 mb-1">
                      <form action="./delete-prestacion" method="POST"
                        onclick="return confirm('¿Está seguro que desa eliminar esta prestación?');">
                        <input type="hidden" name="id" value="<%= prestacionServicio.id %>">
                        <button type="submit" data-bs-toggle="tooltip" data-bs-placement="top" title="Elimiar"
                          class="btn btn-outline-danger border"><i class="bi bi-trash"></i></button>
                      </form>
                    </div>
                  </div>
                </td>
              </tr>
              <% }) %>
          </tbody>
        </table>
      </div>
      <br>
      <br>
      <div class="float-start">
        <a href="./add-prestacion" class="btn primary-btn">Nueva prestacion de servicio</a>
      </div>
    </div>
    <%- include('../template/footer') %>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        crossorigin="anonymous"></script>
  </body>

</html>